/* === LAYOUT STANDARD MOBILE RISOLUTIVO === */

/* Container principale - ZERO transform problematici */
.homepage-container {
  width: 100vw;
  height: 100dvh; /* Dynamic viewport height per iOS Safari */
  height: 100vh; /* Fallback per browser non supportati */
  overflow: hidden;
  position: relative;
  background: var(--bg);
  /* CRITICO iOS: NESSUN transform, filter, perspective, backdrop */
  transform: none !important;
  filter: none !important;
  perspective: none !important;
  backdrop-filter: none !important;
  contain: none !important;
  will-change: auto !important;
}

/* === HEADER FISSO === */
.mobile-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: var(--z-header); /* Sotto navbar, sopra content */
  background: var(--bg);
  /* RIMOZIONE ARTEFATTI: nessun bordo, ombra, separatore */
  border: none !important;
  border-bottom: none !important;
  box-shadow: none !important;
  /* Misure standard: 44-56pt */
  min-height: 44pt;
  max-height: 56pt;
  /* CRITICO iOS: nessun transform problematico */
  transform: none !important;
  will-change: auto !important;
  contain: none !important;
}

/* Rimuovi eventuali pseudo-elementi separatori */
.mobile-header::before,
.mobile-header::after {
  display: none !important;
}

.header-content {
  /* SAFE-AREA ADATTIVA + 8pt */
  padding-top: calc(var(--safe-top) + 8pt);
  padding-bottom: 8pt;
  padding-left: calc(16pt + var(--safe-left));
  padding-right: calc(16pt + var(--safe-right));
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 44pt;
}

.mobile-header .logo-wrap {
  display: flex;
  justify-content: center;
  align-items: center;
}

.mobile-header .logo-wrap img {
  height: 40pt;
  width: auto;
  object-fit: contain;
}

/* === CONTENT SCROLLABILE === */
.mobile-content {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: var(--z-base); /* Sotto header e navbar */
  /* PADDING DINAMICO ADATTIVO per header e navbar */
  /* Header: var(--safe-top) + 8pt + 44-56pt = ~60pt */
  padding-top: calc(var(--safe-top) + 60pt);
  /* Navbar: var(--safe-bottom) + 12pt + 56pt - 8pt offset = ~60pt adattivo */
  padding-bottom: calc(var(--safe-bottom) + 60pt);
  overflow: hidden;
  /* ZERO gap: nessun margin aggiuntivo */
  margin: 0 !important;
}

.wine-list-container {
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: none;
  touch-action: pan-y;
  scroll-behavior: smooth;
  /* Padding laterale standard */
  padding-left: 16pt;
  padding-right: 16pt;
  /* PADDING VERTICALE MINIMALE - eliminare gap */
  padding-top: 2pt; /* Respiro minimo sopra */
  padding-bottom: 2pt; /* Respiro minimo sotto */
  /* ZERO margin per eliminare completamente gap */
  margin: 0 !important;
  /* ASSICURA che ultima card sia sempre 100% visibile */
}

/* === NAVBAR FISSA === */
.mobile-navbar {
  position: fixed;
  bottom: var(--nav-bottom-offset, calc(env(safe-area-inset-bottom) + 4pt)); /* RIDOTTO ~20%: da 8pt a 4pt + safe-area */
  left: 0;
  right: 0;
  z-index: var(--z-navbar); /* Sopra header e content */
  background: var(--bg);
  /* RIMOZIONE ARTEFATTI: nessun bordo, gap, separatore */
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  /* PADDING DINAMICO ADATTIVO per safe-area */
  /* Top: 8pt spazio interno */
  /* Bottom: 8pt spazio controllato (ridotto da 12pt) */
  /* Left/Right: var(--safe-left/right) + 8pt spazio laterale */
  padding: 8pt calc(env(safe-area-inset-left) + 8pt) 8pt calc(env(safe-area-inset-right) + 8pt);
  /* ALTEZZA TOTALE: 56-64px per standard app */
  min-height: 56px;
  /* LAYOUT FLEX per distribuzione icone */
  display: flex;
  align-items: center;
  justify-content: space-between;
  /* BACKDROP GLASSMORPHISM per look app-nativo */
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

/* Rimuovi eventuali pseudo-elementi separatori */
.mobile-navbar::before,
.mobile-navbar::after {
  display: none !important;
}

/* === PULSANTI NAVBAR === */
.mobile-navbar .nav-btn {
  height: 44pt; /* Touch target minimo */
  background: transparent;
  border: none;
  outline: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0;
  color: var(--text);
  cursor: pointer;
  position: relative;
  /* Touch target e accessibilità */
  min-width: 44pt;
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent !important;
  /* MOBILE: Previeni colori di sistema */
  -webkit-appearance: none !important;
  appearance: none !important;
}

.mobile-navbar .nav-btn:not(.btn-tutti) {
  width: 44pt;
  flex-shrink: 0;
}

.mobile-navbar .nav-btn .icon {
  width: 24pt;
  height: 24pt;
  background: var(--text);
  flex-shrink: 0;
}

/* Nascondi label tranne "Tutti" */
.mobile-navbar .nav-btn:not(.btn-tutti) .label {
  display: none;
}

.mobile-navbar .nav-btn:focus-visible {
  box-shadow: 0 0 0 3px rgba(84, 17, 17, 0.18);
  border-radius: 10pt;
}

/* === ICONE SPECIFICHE === */
.mobile-navbar .btn-ordine .icon {
  -webkit-mask: url("/carrello.png") center/contain no-repeat;
  mask: url("/carrello.png") center/contain no-repeat;
}

.mobile-navbar .btn-filtri .icon {
  -webkit-mask: url("/filtro.png") center/contain no-repeat;
  mask: url("/filtro.png") center/contain no-repeat;
  width: 17pt;
  height: 17pt;
}

.mobile-navbar .btn-allert .icon {
  -webkit-mask: url("/allert.png") center/contain no-repeat;
  mask: url("/allert.png") center/contain no-repeat;
}

.mobile-navbar .btn-search .icon {
  /* Icona lente - usa lente.png con mask pattern */
  -webkit-mask: url("/lente.png") center/contain no-repeat;
  mask: url("/lente.png") center/contain no-repeat;
  width: 24pt;
  height: 24pt;
}

/* === GRUPPO ICONE === */
.mobile-navbar .nav-icons-group {
  display: flex;
  align-items: center;
  gap: var(--nav-icon-gap, 8pt);
  
  /* Offset verticale per spostare icone verso basso del 25% */
  transform: translateY(var(--nav-icon-vert-offset, 6pt));
  
  /* Variabili locali per controllo granulare */
  --nav-icon-gap: 8pt;
  --nav-icon-vert-offset: 6pt; /* Sposta icone verso basso di 6pt (circa 25% di 24pt) */
  --nav-safe-bottom: calc(env(safe-area-inset-bottom, 0px) + 12pt);
}

/* === CHIP "TUTTI" === */
.mobile-navbar .btn-tutti {
  background: #FFFFFF !important;
  border: 1px solid var(--border) !important;
  border-radius: 12pt !important;
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 4pt !important;
  padding: 8pt 16pt !important;
  min-width: 120pt !important;
  min-height: 36pt !important;
  box-shadow: 0 1px 3px rgba(84, 17, 17, 0.1) !important;
  margin-left: auto !important;
}

.mobile-navbar .btn-tutti .label {
  display: block !important;
  color: #541111 !important;
  text-align: center !important;
  font-weight: 600 !important;
  width: 100% !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  transition: font-size 0.2s ease-in-out !important;
  /* Font-size gestito dinamicamente da useAutoSizeText */
}

/* Supporto per vecchia classe bottom-toolbar per compatibilità */
.bottom-toolbar .btn-tutti,
.mobile-navbar .btn-tutti {
  background: #FFFFFF !important;
  border: 1px solid var(--border) !important;
  border-radius: 12pt !important;
  position: relative;
  display: flex !important;
  flex-direction: row !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 4pt !important;
  padding: 8pt 16pt !important;
  min-width: 120pt !important;
  min-height: 36pt !important;
  box-shadow: 0 1px 3px rgba(84, 17, 17, 0.1) !important;
  margin-left: auto !important;
}

.bottom-toolbar .btn-tutti .label,
.mobile-navbar .btn-tutti .label {
  display: block !important;
  color: #541111 !important;
  text-align: center !important;
  font-weight: 600 !important;
  width: 100% !important;
  max-width: none !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  white-space: nowrap !important;
  transition: font-size 0.2s ease-in-out !important;
}

/* Stati hover/active per chip */
.mobile-navbar .btn-tutti:hover {
  box-shadow: 0 2px 6px rgba(84, 17, 17, 0.15) !important;
  transform: translateY(-1px) !important;
}

.mobile-navbar .btn-tutti:active {
  box-shadow: 0 1px 2px rgba(84, 17, 17, 0.2) !important;
  transform: translateY(0) !important;
}

/* Badge notifiche */
.mobile-navbar .nav-btn .badge {
  position: absolute;
  top: 4pt;
  right: 8pt;
  width: 8pt;
  height: 8pt;
  background: var(--warn);
  border-radius: 50%;
  border: 1px solid var(--bg);
}

/* === PULSANTE ALERT SPECIFICO === */
.mobile-navbar .btn-allert {
  /* MOBILE: Forza colori personalizzati, previeni override sistema */
  -webkit-tap-highlight-color: transparent !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  user-select: none !important;
}

.mobile-navbar .btn-allert:focus,
.mobile-navbar .btn-allert:active,
.mobile-navbar .btn-allert:hover {
  /* MOBILE: Mantieni colori personalizzati su tutti gli stati */
  outline: none !important;
  -webkit-tap-highlight-color: transparent !important;
  /* I colori vengono gestiti via style inline in React */
}

.mobile-navbar .btn-allert .icon {
  /* MOBILE: Previeni colori di sistema per l'icona */
  -webkit-mask-composite: source-over !important;
  mask-composite: add !important;
}

/* === DISABILITA HIGHLIGHT CARD DURANTE SCROLL === */
.wine-card {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  user-select: none !important;
  touch-action: manipulation !important;
}

.wine-card:hover,
.wine-card:active,
.wine-card:focus {
  /* Mantieni colore originale, nessun highlight */
  background-color: var(--surface-2) !important;
  transform: none !important;
  box-shadow: var(--shadow) !important;
  outline: none !important;
}

/* === RESPONSIVE ADJUSTMENTS === */

/* iPhone 8/SE e dispositivi bassi */
@media (max-height: 600px) {
  .mobile-header {
    min-height: 40pt;
  }
  
  .mobile-navbar {
    min-height: 52pt;
    /* Clearance ridotta per dispositivi bassi */
    padding-bottom: calc(var(--safe-bottom) + 10pt);
  }
  
  .mobile-content {
    padding-top: calc(var(--safe-top) + 56pt);
    padding-bottom: calc(var(--safe-bottom) + 54pt);
  }
}

/* Landscape su telefoni: layout ultra-compatto */
@media (orientation: landscape) and (max-height: 500px) {
  .mobile-header {
    min-height: 36pt;
  }
  
  .mobile-navbar {
    min-height: 48pt;
    padding-bottom: calc(var(--safe-bottom) + 10pt);
  }
  
  .mobile-content {
    padding-top: calc(var(--safe-top) + 50pt);
    padding-bottom: calc(var(--safe-bottom) + 50pt);
  }
}

/* iPhone 15 Pro Max e dispositivi grandi */
@media (min-height: 800px) {
  .mobile-navbar {
    /* Clearance ottimale per dispositivi grandi */
    padding-bottom: calc(var(--safe-bottom) + 12pt);
  }
  
  .mobile-content {
    padding-bottom: calc(var(--safe-bottom) + 60pt);
  }
}
